---
import { Author } from "../components/Author";
import { BlogPost } from "../components/BlogPost";
import { MorePosts } from "../components/MorePosts";
import { sortPosts } from "../utils/sortPosts";
import type { PostMeta } from "../utils/types";
import Layout from "./Layout.astro";

export type Props = {
  content: PostMeta;
};

const {
  content: { title, description, pubDate },
} = Astro.props;

const latestPosts = sortPosts(await Astro.glob("../pages/blog/*.{md,mdx}"))
  .slice(0, 3)
  .filter(({ url }) => url !== Astro.props.url)
  .slice(0, 2);
---

<Layout title={title}>
  <div
    class="md:flex-row md:items-start flex flex-col justify-between gap-6 relative"
  >
    <BlogPost title={title} pubDate={pubDate}>
      <slot />
    </BlogPost>
    <div class="max-w-lg sticky top-0 pt-14">
      <Author />
      <MorePosts posts={latestPosts} />
    </div>
  </div>
</Layout>
